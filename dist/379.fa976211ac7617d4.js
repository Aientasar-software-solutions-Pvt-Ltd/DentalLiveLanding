"use strict";(self.webpackChunkDentalLive_dev=self.webpackChunkDentalLive_dev||[]).push([[379],{1379:(y,_,u)=>{u.d(_,{LP:()=>k,tV:()=>R,xE:()=>g,RB:()=>L});var h=u(5e3),O=u(7579);class I extends O.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(c){const{hasError:e,_hasValue:t,_value:s,thrownError:n,isStopped:o,_isComplete:r}=this;e?c.error(n):(o||r)&&(t&&c.next(s),c.complete())}next(c){this.isStopped||(this._value=c,this._hasValue=!0)}complete(){const{_hasValue:c,_value:e,_isComplete:t}=this;t||(this._isComplete=!0,c&&super.next(e),super.complete())}}var f=u(4707),P=u(9808);class v{constructor(){}loadScript(c,e,t,s=null){if("undefined"!=typeof document&&!document.getElementById(c)){let n=document.createElement("script");n.async=!0,n.src=e,n.onload=t,s||(s=document.head),s.appendChild(n)}}}class d{}let R=(()=>{class i extends v{constructor(e,t={scope:"email"}){super(),this.clientId=e,this.initOptions=t}initialize(){return new Promise((e,t)=>{try{this.loadScript(i.PROVIDER_ID,"https://apis.google.com/js/api.js",()=>{gapi.load("client:auth2",()=>{gapi.client.init(Object.assign(Object.assign({},this.initOptions),{client_id:this.clientId})).then(()=>{this.auth2=gapi.auth2.getAuthInstance(),e()}).catch(s=>{t(s)})})})}catch(s){t(s)}})}getLoginStatus(e){const t=Object.assign(Object.assign({},this.initOptions),e);return new Promise((s,n)=>{if(this.auth2.isSignedIn.get()){const o=new d,r=this.auth2.currentUser.get().getBasicProfile(),l=this.auth2.currentUser.get().getAuthResponse(!0);this.setUserProfile(o,r),o.response=l;const a=p=>{o.authToken=p.access_token,o.idToken=p.id_token,s(o)};t.refreshToken?this.auth2.currentUser.get().reloadAuthResponse().then(a):a(l)}else n(`No user is currently logged in with ${i.PROVIDER_ID}`)})}signIn(e){const t=Object.assign(Object.assign({},this.initOptions),e);return new Promise((s,n)=>{(t&&t.offline_access?this.auth2.grantOfflineAccess(e):this.auth2.signIn(e)).then(l=>{const a=new d;if(l&&l.code)a.authorizationCode=l.code;else{const p=this.auth2.currentUser.get().getBasicProfile(),m=this.auth2.currentUser.get().getAuthResponse(!0),D=m.access_token,E=m.id_token;this.setUserProfile(a,p),a.authToken=D,a.idToken=E,a.response=m}s(a)},l=>{n(l)}).catch(l=>{n(l)})})}signOut(e){return new Promise((t,s)=>{let n;n=e?this.auth2.disconnect():this.auth2.signOut(),n.then(o=>{o?s(o):t()}).catch(o=>{s(o)})})}setUserProfile(e,t){e.id=t.getId(),e.name=t.getName(),e.email=t.getEmail(),e.photoUrl=t.getImageUrl(),e.firstName=t.getGivenName(),e.lastName=t.getFamilyName()}}return i.PROVIDER_ID="GOOGLE",i})(),g=(()=>{class i{constructor(e){this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new f.t(1),this.initialized=!1,this._initState=new I,e instanceof Promise?e.then(t=>{this.initialize(t)}):this.initialize(e)}get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(s=>{this.providers.set(s.id,s.provider)}),Promise.all(Array.from(this.providers.values()).map(s=>s.initialize())).then(()=>{if(this.autoLogin){const s=[];let n=!1;this.providers.forEach((o,r)=>{let l=o.getLoginStatus();s.push(l),l.then(a=>{a.provider=r,this._user=a,this._authState.next(a),n=!0}).catch(console.debug)}),Promise.all(s).catch(()=>{n||(this._user=null,this._authState.next(null))})}}).catch(s=>{t(s)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}refreshAuthToken(e){return new Promise((t,s)=>{if(this.initialized)if(e!==R.PROVIDER_ID)s(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const n=this.providers.get(e);n?n.getLoginStatus({refreshToken:!0}).then(o=>{o.provider=e,this._user=o,this._authState.next(o),t()}).catch(o=>{s(o)}):s(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(i.ERR_NOT_INITIALIZED)})}signIn(e,t){return new Promise((s,n)=>{if(this.initialized){let o=this.providers.get(e);o?o.signIn(t).then(r=>{r.provider=e,s(r),this._user=r,this._authState.next(r)}).catch(r=>{n(r)}):n(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else n(i.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((t,s)=>{if(this.initialized)if(this._user){let o=this.providers.get(this._user.provider);o?o.signOut(e).then(()=>{t(),this._user=null,this._authState.next(null)}).catch(r=>{s(r)}):s(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(i.ERR_NOT_LOGGED_IN);else s(i.ERR_NOT_INITIALIZED)})}}return i.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",i.ERR_NOT_LOGGED_IN="Not logged in",i.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",i.\u0275fac=function(e){return new(e||i)(h.LFG("SocialAuthServiceConfig"))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),L=(()=>{class i{constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}static initialize(e){return{ngModule:i,providers:[g,{provide:"SocialAuthServiceConfig",useValue:e}]}}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(i,12))},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[g],imports:[[P.ez]]}),i})(),k=(()=>{class i extends v{constructor(e,t={}){super(),this.clientId=e,this.requestOptions={scope:"email,public_profile",locale:"en_US",fields:"name,email,picture,first_name,last_name",version:"v10.0"},this.requestOptions=Object.assign(Object.assign({},this.requestOptions),t)}initialize(){return new Promise((e,t)=>{try{this.loadScript(i.PROVIDER_ID,`//connect.facebook.net/${this.requestOptions.locale}/sdk.js`,()=>{FB.init({appId:this.clientId,autoLogAppEvents:!0,cookie:!0,xfbml:!0,version:this.requestOptions.version}),e()})}catch(s){t(s)}})}getLoginStatus(){return new Promise((e,t)=>{FB.getLoginStatus(s=>{if("connected"===s.status){let n=s.authResponse;FB.api(`/me?fields=${this.requestOptions.fields}`,o=>{let r=new d;r.id=o.id,r.name=o.name,r.email=o.email,r.photoUrl="https://graph.facebook.com/"+o.id+"/picture?type=normal&access_token="+n.accessToken,r.firstName=o.first_name,r.lastName=o.last_name,r.authToken=n.accessToken,r.response=o,e(r)})}else t(`No user is currently logged in with ${i.PROVIDER_ID}`)})})}signIn(e){const t=Object.assign(Object.assign({},this.requestOptions),e);return new Promise((s,n)=>{FB.login(o=>{if(o.authResponse){let r=o.authResponse;FB.api(`/me?fields=${t.fields}`,l=>{let a=new d;a.id=l.id,a.name=l.name,a.email=l.email,a.photoUrl="https://graph.facebook.com/"+l.id+"/picture?type=normal",a.firstName=l.first_name,a.lastName=l.last_name,a.authToken=r.accessToken,a.response=l,s(a)})}else n("User cancelled login or did not fully authorize.")},t)})}signOut(){return new Promise((e,t)=>{FB.logout(s=>{e()})})}}return i.PROVIDER_ID="FACEBOOK",i})()}}]);