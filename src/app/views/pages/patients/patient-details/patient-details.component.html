<ol class="breadcrumb">
  <!-- breadcrumb -->
  <li class="breadcrumb-item">
    <a routerLink="/dashboard"
      ><i class="bx bxs-home" aria-hidden="true"></i> Dashboard</a
    >
  </li>
  <li class="breadcrumb-item">
    <a routerLink="/patients">Patients</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">Patient View</li>
</ol>
<ng-container class="mt-3" *ngIf="isLoadingData">
  <div class="col-md-12">
    <lottie-player
      class="mt-3 m-auto"
      src="https://assets6.lottiefiles.com/packages/lf20_fhsx0ijl/lottie/collections-feature.json"
      background="transparent"
      speed="1"
      style="width: 300px; height: 300px"
      loop
      autoplay
    ></lottie-player>
    <h6 class="text-center mt-5">
      Request Processing â€¦..Please Wait, Do Not Close The Page
    </h6>
  </div>
</ng-container>
<ng-container *ngIf="!isLoadingData">
  <div class="page-header row align-items-center gx-0">
    <div class="col-md-12">
      <h3 class="my-2 my-md-0" id="heading1">
        Patient Overview :
        <a
          tippy="Tutorial"
          target="_blank"
          [routerLink]="
            '/tutorial/' + utility.tutorialData['PatientDetailsComponent'].html
          "
        >
          <i class="bx bxs-info-circle text-primary"></i
        ></a>
        <button
          class="accordion-button d-inline-flex"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#collapse1"
          aria-expanded="true"
          aria-controls="collapse1"
        >
          {{ baseData.firstName }} {{ baseData.lastName }}
        </button>
      </h3>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="accordion-overview" id="accordionOverview">
        <div class="accordion-item shadow-sm border-0">
          <div
            id="collapse1"
            class="accordion-collapse collapse show"
            aria-labelledby="heading1"
            data-bs-parent="#accordionOverview"
          >
            <div
              class="accordion-body mb-4"
              style="box-shadow: 0px 12px 22px rgba(203, 237, 253, 0.5)"
            >
              <div class="row gx-2">
                <div class="col-md-3 col-lg-3 col-xl-2">
                  <div class="profile-img justify-content-center p-md-2">
                    <img
                      [src]="
                        baseData.image
                          ? utility.apiData.patients.bucketUrl + baseData.image
                          : '../../assets/images/users.png'
                      "
                      alt=""
                      class="mb-2 rounded-circle"
                    />
                  </div>
                </div>
                <div class="col-md-9 col-lg-9 col-xl-10">
                  <div class="row">
                    <div class="col-md-5">
                      <div class="mb-1 row">
                        <label class="col-sm-5 col-form-label body2"
                          >Patient ID</label
                        >
                        <div class="col-sm-7">
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="{{ baseData.patientId }}"
                          />
                        </div>
                      </div>
                      <div class="mb-1 row">
                        <label class="col-sm-5 col-form-label body2"
                          >Reference ID</label
                        >
                        <div class="col-sm-7">
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="{{ baseData.refId }}"
                          />
                        </div>
                      </div>
                      <div class="mb-1 row">
                        <label class="col-sm-5 col-form-label body2"
                          >Date of Birth</label
                        >
                        <div class="col-sm-7">
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="{{ baseData.dob | date : 'mediumDate' }}"
                          />
                        </div>
                      </div>
                      <div class="mb-1 row">
                        <label class="col-sm-5 col-form-label body2"
                          >Gender
                        </label>
                        <div class="col-sm-7">
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="Male"
                            *ngIf="baseData.gender == 0"
                          />
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="Female"
                            *ngIf="baseData.gender == 1"
                          />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-7">
                      <div class="mb-1 row">
                        <label class="col-sm-5 col-form-label body2"
                          >Insurance Policy No.</label
                        >
                        <div class="col-sm-7">
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="{{ baseData.insurance.policyno }}"
                          />
                        </div>
                      </div>
                      <div class="mb-1 row">
                        <label class="col-sm-5 col-form-label body2"
                          >Insurance Co.</label
                        >
                        <div class="col-sm-7">
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="{{ baseData.insurance.carrier }}"
                          />
                        </div>
                      </div>
                      <div class="mb-1 row">
                        <label class="col-sm-5 col-form-label body2"
                          >Email</label
                        >
                        <div class="col-sm-7">
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="{{ baseData.email }}"
                          />
                        </div>
                      </div>
                      <div class="mb-1 row">
                        <label class="col-sm-5 col-form-label body2"
                          >Phone Number</label
                        >
                        <div class="col-sm-7">
                          <input
                            type="text"
                            readonly=""
                            class="form-control-plaintext body2 text-muted"
                            value="{{ getPhoneNumber(baseData.phone) }}"
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div
                *ngIf="
                  baseData.notes &&
                  (baseData.notes?.text || baseData.notes?.links.length > 0)
                "
              >
                <h5 class="body1 card-title my-2 mt-4">Notes</h5>
                <app-cvfast-viewer
                  [cvfast]="baseData.notes"
                ></app-cvfast-viewer>
              </div>
              <div
                class="d-block text-end my-2"
                *ngIf="baseData.resourceOwner == user.emailAddress"
              >
                <a
                  routerLink="/patients/patient-edit/{{ baseData.patientId }}"
                  class="btn btn-light-green px-3"
                  tippy="Edit"
                  ><i class="bx bx-pencil fs-5 align-middle"></i> Edit</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row align-items-center">
    <div class="col-md-12">
      <div
        class="card shadow-sm"
        style="box-shadow: 0px 12px 22px rgba(208, 210, 218, 0.15)"
      >
        <div
          class="card-header border-bottom-0"
          style="background-color: #ffff"
        >
          <div
            class="mt-2 d-flex justify-content-between align-items-center flex-wrap"
          >
            <div class="mb-2">
              <h5 class="card-title mb-0">Patient Cases</h5>
            </div>
            <div class="d-flex flex-wrap align-items-center">
              <a
                routerLink="/cases/cases/case-add/{{ baseData.patientId }}"
                *ngIf="baseData.resourceOwner == this.user.emailAddress"
                class="btn btn-light-green me-2 mb-2"
              >
                <i class="bx bx-briefcase-alt"></i> Add Case
              </a>
              <a
                routerLink="/mail/inbox/{{ baseData.patientId }}"
                class="btn btn-pink me-2 mb-2"
              >
                <i class="bx bx-envelope"></i> Mail
              </a>
              <a
                routerLink="/meet/meet/{{ baseData.patientId }}"
                class="btn btn-default mb-2"
              >
                <i class="bx bx-video"></i> Video Conference
              </a>
            </div>
          </div>
        </div>
        <app-case-list *ngIf="id" [patientId]="id"></app-case-list>
      </div>
    </div>
  </div>
</ng-container>
