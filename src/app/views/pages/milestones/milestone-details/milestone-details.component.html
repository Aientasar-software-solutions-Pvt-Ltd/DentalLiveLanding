<ol *ngIf="!hasCase" class="breadcrumb">
  <!-- breadcrumb -->
  <li class="breadcrumb-item">
    <a routerLink="/dashboard"
      ><i class="bx bxs-home" aria-hidden="true"></i> Dashboard</a
    >
  </li>
  <li class="breadcrumb-item">
    <a routerLink="{{ backUrl }}">Milestones</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">Milestone Details</li>
</ol>
<div *ngIf="isLoadingData" class="row">
  <div class="col-md-12">
    <lottie-player
      class="mt-3 m-auto"
      src="https://assets6.lottiefiles.com/packages/lf20_fhsx0ijl/lottie/collections-feature.json"
      background="transparent"
      speed="1"
      style="width: 300px; height: 300px"
      loop
      autoplay
    ></lottie-player>
    <h6 class="text-center mt-5">
      Request Processing â€¦..Please Wait, Do Not Close The Page
    </h6>
  </div>
</div>

<div [hidden]="isLoadingData">
  <div *ngIf="!hasCase" class="page-header row align-items-center gx-0">
    <div class="col-md-6">
      <div class="d-inline-block">
        <h3 class="mt-2 fw-normal">
          {{
            utility.getMetaData(
              baseData.patientId,
              "patientId",
              ["firstName", "lastName"],
              "patients"
            )
          }}
          <span class="fw-bold d-block">{{
            utility.getMetaData(baseData.caseId, "caseId", ["title"], "cases")
          }}</span>
          <div class="progress progress-sm mt-2">
            <div
              class="progress-bar bg-primary"
              role="progressbar"
              style="width: 55%"
              aria-valuenow="55"
              aria-valuemin="0"
              aria-valuemax="100"
            ></div>
          </div>
        </h3>
      </div>
    </div>
    <div class="col-md-6 text-end"></div>
  </div>

  <div class="row align-items-center pt-2">
    <div class="col-md-12">
      <div class="card shadow-sm">
        <div class="card-header bg-white">
          <div class="row">
            <div class="col-md-5 align-self-center">
              <h5 class="body1 card-title my-2">Milestone Details</h5>
            </div>
            <div class="col-md-7 text-end">
              <a
                [routerLink]="
                  hasCase
                    ? '/cases/cases/case-view/' +
                      baseData.caseId +
                      '/milestones'
                    : backUrl
                "
                class="btn btn-default"
                >Back</a
              >
            </div>
            <div class="col-md-5">
              <div class="panel panel-primary mt-3">
                <div class="tab-menu-heading">
                  <div class="tabs-menu">
                    <!-- Tabs -->
                    <ul class="nav panel-tabs">
                      <li>
                        <a
                          class="me-1 isCursor"
                          [class.active]="tab == 0"
                          (click)="tab = 0"
                          >Details</a
                        >
                      </li>
                      <li>
                        <a
                          class="me-1 isCursor"
                          [class.active]="tab == 1"
                          (click)="tab = 1"
                          >Thread</a
                        >
                      </li>
                      <li>
                        <a
                          class="me-1 isCursor"
                          [class.active]="tab == 2"
                          (click)="tab = 2"
                          >Tasks</a
                        >
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-7 text-end">
              <div class="avatar-list justify-content-end mt-2 my-1 ms-2">
                <span
                  class="avatar-icon my-1 ms-2"
                  style="background-color: #fff"
                  >&nbsp;</span
                >
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="tab == 0">
          <div class="card-body">
            <div class="row mt-2">
              <div class="col-md-12">
                <div class="row">
                  <div class="col-md-8">
                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label">Owner</label>
                      <div class="col-sm-8">
                        <input
                          class="form-control"
                          type="text"
                          value="{{
                            utility.getMetaData(
                              baseData['resourceOwner'],
                              'emailAddress',
                              ['accountfirstName', 'accountlastName'],
                              'users'
                            )
                          }}"
                          aria-label="readonly input example"
                          readonly
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-md-8">
                    <div class="mb-3 row">
                      <label for="title" class="col-sm-3 col-form-label"
                        >Title</label
                      >
                      <div class="col-sm-8">
                        <input
                          class="form-control"
                          type="text"
                          name="title"
                          id="title"
                          value="{{ baseData.title }}"
                          aria-label="readonly input example"
                          readonly
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-md-2">
                    <label class="form-label body2 text-gray">Start Date</label>
                    <div class="mb-4">
                      <input
                        type="text"
                        readonly
                        class="form-control-plaintext"
                        value="{{ baseData.startdate | date : 'mediumDate' }}"
                      />
                    </div>
                  </div>
                  <div class="col-md-2">
                    <label class="form-label body2 text-gray">Due Date</label>
                    <div class="mb-4">
                      <input
                        type="text"
                        readonly
                        class="form-control-plaintext"
                        value="{{ baseData.duedate | date : 'mediumDate' }}"
                      />
                    </div>
                  </div>

                  <h5 class="body1 card-title my-2 border-top pt-4 mt-4">
                    Description
                  </h5>
                  <app-cvfast-viewer
                    *ngIf="!isLoadingData"
                    [cvfast]="baseData.description"
                  ></app-cvfast-viewer>
                </div>
              </div>
            </div>
          </div>
          <!-- </form> -->
        </div>
        <div *ngIf="tab == 1">
          <div class="card-body">
            <app-case-message
              *ngIf="!isLoadingData"
              [messageType]="utility.apiData[module].messageType"
              [messageReferenceId]="baseData.milestoneId"
              [caseId]="baseData.caseId"
            ></app-case-message>
          </div>
        </div>
        <div *ngIf="tab == 2">
          <app-general-task-list></app-general-task-list>
        </div>
      </div>
    </div>
  </div>
</div>
